<!DOCTYPE html>
<html>
  <head>
    <title>Photogram</title>
  </head>
  <body>
    <nav>
      <ul>
        <li><a href="/users">All users</a></li>
        <li><a href="/photos">All public photos</a></li>
        <% if user_signed_in? %>
          <li><a href="/users/<%= current_user.username %>"><%= current_user.username %></a></li>
          <li><a href="/users/sign_out">Sign out</a></li>
        <% else %>
          <li><a href="/users/sign_in">Sign in</a></li>
          <li><a href="/users/sign_up">Sign up</a></li>
        <% end %>
      </ul>
    </nav>

    <h1>List of users</h1>
    <table>
      <thead>
        <tr>
          <th>Username</th>
          <th>Private?</th>
          <% if user_signed_in? %>
            <th>Follow/Unfollow</th>
          <% end %>
          <th>Details</th>
        </tr>
      </thead>
      <tbody>
        <% @users.each do |user| %>
          <tr>
            <td><%= user.username %></td>
            <td><%= user.private ? "Yes" : "No" %></td>
            <% if user_signed_in? %>
              <td>
                <% if @current_user.following?(user) %>
                  <%= button_to "Unfollow", unfollow_user_path(user), method: :post %>
                <% elsif @current_user.pending_follow_request?(user) %>
                  Request sent. <%= link_to "Cancel", cancel_follow_request_path(user), method: :post %>
                <% else %>
                  <%= button_to "Follow", follow_user_path(user), method: :post %>
                <% end %>
              </td>
            <% end %>
            <td><a href="/users/<%= user.id %>">Show details</a></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </body>
</html>
